# 1단계: 핵심 기능 완성

## 🎯 단계 목표

현재 구현된 기능들의 완성도를 높이고, 실제 운영에 필요한 핵심 기능들을 완성합니다.

## 📅 예상 기간: 2-3일

## 🎯 주요 과업

### 1. 대시보드 데이터 연동

**현재 상태:** Placeholder 위젯만 존재
**목표:** 실제 Supabase 데이터 기반 통계 표시

#### 구현 항목:

- [ ] Total Quotes 카드: `project_requests` 테이블 count
- [ ] New Inquiries 카드: `inquiries` 테이블 count (최근 7일)
- [ ] System Status: 서버 상태 체크
- [ ] 최근 문의 목록 (5개)
- [ ] 최근 견적 목록 (5개)
- [ ] 차트/그래프 기반 시각화

#### 기술적 고려사항:

```typescript
// Supabase RPC 함수 활용
const getDashboardStats = async () => {
  const { data } = await supabase.rpc('get_dashboard_stats');
  return data;
};
```

### 2. 문의 관리 CRUD 구현

**현재 상태:** 기본 리스트만 존재
**목표:** 완전한 CRUD 기능 구현

#### 구현 항목:

- [ ] **Create:** 문의 작성 기능 개선
- [ ] **Read:** 상세 보기, 비밀번호 확인
- [ ] **Update:** 관리자 수정 기능
- [ ] **Delete:** 관리자 삭제 기능
- [ ] **검색:** 제목, 작성자, 내용 검색
- [ ] **필터링:** 공지/일반, 비공개 필터
- [ ] **정렬:** 최신순, 조회수순
- [ ] **페이징:** 페이지네이션 구현

#### UI/UX 개선:

- [ ] 테이블 형태 리스트
- [ ] 검색 바 및 필터 UI
- [ ] 모달/사이드바 상세 보기
- [ ] 일괄 선택 및 액션

### 3. 견적 관리 기능 완성

**현재 상태:** 폼 제출만 가능
**목표:** 관리자용 견적 관리 시스템

#### 구현 항목:

- [ ] 견적 목록 (상태, 날짜, 고객 정보)
- [ ] 상세 보기 (모든 폼 데이터 표시)
- [ ] 상태 관리 (접수 → 검토 → 제안 → 완료)
- [ ] 메모/코멘트 기능
- [ ] 고객 정보 관리
- [ ] 검색 및 필터링

#### 데이터 모델 확장:

```sql
-- project_requests 테이블에 상태 컬럼 추가
ALTER TABLE project_requests
ADD COLUMN status VARCHAR(20) DEFAULT 'pending',
ADD COLUMN admin_notes TEXT,
ADD COLUMN updated_at TIMESTAMP DEFAULT NOW();
```

### 4. 기본 검색 및 필터링

**목표:** 모든 리스트 페이지에서 일관된 검색/필터 경험 제공

#### 구현 항목:

- [ ] 통합 검색 컴포넌트
- [ ] 필터 UI 컴포넌트
- [ ] URL 쿼리 파라미터 연동
- [ ] 검색 결과 하이라이트
- [ ] 검색 기록/즐겨찾기

## 🛠️ 기술 구현 방안

### 1. Supabase RPC 함수

```sql
CREATE OR REPLACE FUNCTION get_dashboard_stats()
RETURNS JSON AS $$
DECLARE
  result JSON;
BEGIN
  SELECT json_build_object(
    'total_quotes', (SELECT COUNT(*) FROM project_requests),
    'new_inquiries', (SELECT COUNT(*) FROM inquiries WHERE created_at > NOW() - INTERVAL '7 days'),
    'pending_quotes', (SELECT COUNT(*) FROM project_requests WHERE status = 'pending')
  ) INTO result;

  RETURN result;
END;
$$ LANGUAGE plpgsql;
```

### 2. 컴포넌트 구조

```
src/components/admin/
├── Dashboard/
│   ├── StatCard.tsx
│   ├── RecentList.tsx
│   └── ChartWidget.tsx
├── Inquiries/
│   ├── InquiryList.tsx
│   ├── InquiryDetail.tsx
│   ├── InquiryForm.tsx
│   └── SearchFilter.tsx
└── Quotes/
    ├── QuoteList.tsx
    ├── QuoteDetail.tsx
    └── StatusManager.tsx
```

### 3. 상태 관리

```typescript
// React Query 또는 SWR 활용
const useDashboardStats = () => {
  return useQuery({
    queryKey: ['dashboard-stats'],
    queryFn: getDashboardStats,
    refetchInterval: 30000, // 30초마다 갱신
  });
};
```

## ✅ 완료 기준

### 기능적 기준:

- [ ] 대시보드 모든 위젯이 실제 데이터 표시
- [ ] 문의 CRUD 모든 기능 정상 작동
- [ ] 견적 상태 변경 및 관리 가능
- [ ] 검색/필터 모든 페이지에서 일관되게 작동

### 성능적 기준:

- [ ] 페이지 로드 시간 < 2초
- [ ] 검색 응답 시간 < 500ms
- [ ] 대시보드 데이터 갱신 < 1초

### 품질 기준:

- [ ] TypeScript 타입 완전히 정의
- [ ] 에러 핸들링 모든 경우에 구현
- [ ] 로딩 상태 모든 API 호출에 구현
- [ ] 반응형 디자인 모바일까지 지원

## 🚀 다음 단계 준비

- 2단계에서 필요한 인증/권한 시스템 기반 구축
- 컴포넌트 재사용성 확보
- API 응답 포맷 표준화
- 에러 처리 패턴 확립

---

_본 단계가 완료되면 프로젝트의 핵심 기능이 모두 작동하게 됩니다_
